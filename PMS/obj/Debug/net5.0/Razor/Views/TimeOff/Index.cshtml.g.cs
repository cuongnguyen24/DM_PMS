#pragma checksum "D:\ETek\DM_PMS-master\PMS\Views\TimeOff\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "e0733957468c0654e1d1aa83e88addafbdaf07d3"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_TimeOff_Index), @"mvc.1.0.view", @"/Views/TimeOff/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\ETek\DM_PMS-master\PMS\Views\_ViewImports.cshtml"
using PMS;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\ETek\DM_PMS-master\PMS\Views\_ViewImports.cshtml"
using PMS.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"e0733957468c0654e1d1aa83e88addafbdaf07d3", @"/Views/TimeOff/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"93ce4f72f6dfce34342b9241fe3c069991c39bf1", @"/Views/_ViewImports.cshtml")]
    #nullable restore
    public class Views_TimeOff_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    #nullable disable
    {
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.OptionTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 1 "D:\ETek\DM_PMS-master\PMS\Views\TimeOff\Index.cshtml"
  
    ViewData["Title"] = "QUẢN LÝ NGHỈ PHÉP";
    Layout = "~/Views/Shared/_Layout.cshtml";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"<link rel=""stylesheet"" href=""https://cdn.jsdelivr.net/npm/handsontable@14.3.0/dist/handsontable.full.min.css"" />

<div class=""row"">
    <div class=""col-12"">
        <div class=""card"">
            <div class=""card-body"">
                <h4 class=""card-title"">BẢNG TỔNG HỢP SỐ LIỆU THEO DÕI NGHỈ PHÉP NĂM 2025</h4>

                <!-- Bộ lọc -->
                <div class=""row mt-3 mb-3"">
                    <div class=""col-md-2"">
                        <label>Chọn thời gian:</label>
                        <select class=""form-control"" id=""selectYear"">
                            ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("option", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "e0733957468c0654e1d1aa83e88addafbdaf07d33857", async() => {
                WriteLiteral("Năm");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.OptionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"
                        </select>
                    </div>
                    <div class=""col-md-2 align-self-end"">
                        <button id=""btnTimKiem"" class=""btn btn-info"">Tìm kiếm</button>
                    </div>
                    <div class=""col-md-2 align-self-end"">
                        <button id=""btnXuatExcel"" class=""btn btn-primary"">Xuất Excel</button>
                    </div>
                </div>

                <!-- Bảng Handsontable -->
                <div class=""table-responsive"" id=""leaveTrackingWrapper"" style=""overflow:auto;"">
                    <div id=""leaveTrackingTable""></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src=""https://cdn.jsdelivr.net/npm/handsontable@14.3.0/dist/handsontable.full.min.js""></script>
<script>
    document.addEventListener(""DOMContentLoaded"", function () {
        const container = document.getElementById('leaveTrackingTable');

        const nestedHeaders = [
            [
                'TT'");
            WriteLiteral(@", 'HỌ VÀ TÊN', 'Mã nhân viên',
                { label: 'Ngày tuyển dụng', colspan: 3 },
                { label: 'Số năm lao động tính đến 31/12/24', colspan: 2 },
                'Số ngày phép theo chế độ', 'Số ngày đã nghỉ cả năm',
                'Số ngày phép còn lại',
                { label: 'Số liệu chi tiết từng tháng', colspan: 12 },
                'Chuyển phép sang tháng 01/2026'
            ],
            ['', '', '',
                'ngày', 'tháng', 'năm',
                'Năm', 'Tháng',
                '', '', '',
                'T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12',
                ''
            ]
        ];

        const columns = [
            { data: 0, type: 'numeric', width: 40 },  // TT
            { data: 1, type: 'text', width: 160 },    // Họ và tên
            { data: 2, type: 'text', width: 100 },    // Mã nhân viên
            { data: 3, type: 'numeric', width: 50 },  // Ngày
            { data: 4, type: 'numeric', width: 50 },  // Tháng
     ");
            WriteLiteral(@"       { data: 5, type: 'numeric', width: 60 },  // Năm
            { data: 6, type: 'numeric', width: 60 },  // Số năm
            { data: 7, type: 'numeric', width: 60 },  // Số tháng
            { data: 8, type: 'numeric', width: 60 },  // Số ngày phép chế độ
            { data: 9, type: 'numeric', width: 60 },  // Số ngày đã nghỉ
            { data: 10, type: 'numeric', width: 60 }, // Còn lại
            // T1 đến T12
            ...Array.from({ length: 12 }, (_, i) => ({
                data: 11 + i,
                type: 'numeric',
                width: 50
            })),
            { data: 23, type: 'numeric', width: 100 } // Chuyển phép
        ];

        const sampleData = [
            [1, 'Nguyễn 111', 'zzz', 3, 2, 1990, 35, 11, 19, null, null],
            [2, 'Nguyễn 112', 'zzz', 2, 1, 2008, 16, 7, 18, 3, 15],
            [3, 'Nguyễn 113', 'zzz', 3, 8, 2008, 16, 4, 18, 3, 15],
            [4, 'Nguyễn 114', 'zzz', 3, 8, 2008, 16, 4, 18, 3, 15],
            [5, 'Nguyễn 115', 'zzz', 14, 8, 2000");
            WriteLiteral(@", 24, 4, 17, null, null],
            [6, 'Nguyễn 116', 'zzz', 6, 11, 1991, 33, 1, 17, null, null],
            [7, 'Nguyễn 117', 'zzz', 7, 8, 1999, 25, 5, 17, null, null]
        ];

        const hot = new Handsontable(container, {
            data: sampleData,
            columns: columns,
            nestedHeaders: nestedHeaders,
            rowHeaders: true,
            colHeaders: false,
            width: '100%',
            height: calculateHotHeight(),
            stretchH: 'all',
            fixedColumnsLeft: 3,
            manualColumnMove: true,
            manualColumnFreeze: true,
            contextMenu: true,
            dropdownMenu: true,
            filters: true,
            licenseKey: 'non-commercial-and-evaluation'
        });

        // Resize responsive
        function calculateHotHeight() {
            const windowHeight = window.innerHeight;
            return Math.max(windowHeight - 360, 400);
        }

        window.addEventListener('resize', () => {
            hot.updateSett");
            WriteLiteral(@"ings({ height: calculateHotHeight() });
        });

        document.getElementById('btnTimKiem').addEventListener('click', function () {
            alert(""Tìm kiếm chưa kết nối backend."");
        });

        document.getElementById('btnXuatExcel').addEventListener('click', function () {
            alert(""Chức năng xuất Excel sẽ được tích hợp sau."");
        });
    });
</script>
");
        }
        #pragma warning restore 1998
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; } = default!;
        #nullable disable
    }
}
#pragma warning restore 1591
